"use strict";(self.webpackChunkplentymarkets_feedback=self.webpackChunkplentymarkets_feedback||[]).push([[5],{2692:function(e,t,a){a.d(t,{Z:function(){return l}});a(2222),a(7327),a(1249);var n=!1,r=!1,s={setFeedbackAuthenticatedUser:function(e,t){e.authenticatedUser=t},setFeedbackCounts:function(e,t){e.counts=t},setFeedbacks:function(e,t){e.feedbacks=e.feedbacks.concat(t)},setFeedbackItemAttributes:function(e,t){e.itemAttributes=t},setFeedbackPagination:function(e,t){e.pagination.lastPage=t.lastPage,e.pagination.isLastPage=t.isLastPage},incrementCurrentFeedbackPage:function(e){e.pagination.currentPage++},addFeedback:function(e,t){if(e.authenticatedUser.feedbacks.unshift(t),t.isVisible){var a=parseInt(t.feedbackRating.rating.ratingValue);a>0&&a<=5&&(e.counts["ratingsCountOf"+a]++,e.counts.ratingsCountTotal++,d(e))}},deleteFeedback:function(e,t){var a=t.feedbackId,n=t.parentFeedbackId,r=t.feedback;if(r.isVisible&&null===n){var s=parseInt(r.feedbackRating.rating.ratingValue);s>0&&s<=5&&(e.counts["ratingsCountOf"+s]--,e.counts.ratingsCountTotal--,d(e))}null===n?(e.feedbacks=u(e.feedbacks,a),e.authenticatedUser.feedbacks=u(e.authenticatedUser.feedbacks,a)):(e.feedbacks=f(e.feedbacks,n,a),e.authenticatedUser.feedbacks=f(e.authenticatedUser.feedbacks,n,a))}},c={loadFeedbackUser:function(e,t){var a=e.commit,n=t.itemId,s=t.variationId;if(!r){r=!0;var c="";return void 0!==n&&void 0!==s&&(c="/".concat(n,"/").concat(s)),$.ajax({type:"GET",url:"/rest/feedbacks/user"+c,success:function(e){a("setFeedbackAuthenticatedUser",e),r=!1},error:function(e,t,a){r=!1,console.error(a)}})}},loadFeedbackCounts:function(e,t){var a=e.commit;e.state;if(!i)return i=!0,$.ajax({type:"GET",url:"/rest/feedbacks/feedback/helper/counts/"+t,success:function(e){a("setFeedbackCounts",e.counts)},error:function(e,t,a){console.error(a)}})},loadPaginatedFeedbacks:function(e,t){var a=e.commit,r=e.state,s=t.itemId,c=t.feedbacksPerPage;if(!n){n=!0;var i=$.ajax({type:"GET",url:"http://localhost:8042/rest/storefront/feedbacks/feedback/helper/feedbacklist/"+s+"/"+r.pagination.currentPage,data:{feedbacksPerPage:c},success:function(e){a("setFeedbacks",e.feedbacks),a("setFeedbackItemAttributes",e.itemAttributes),a("setFeedbackPagination",e.pagination),n=!1},error:function(e,t,a){console.error(a),n=!1}});return a("incrementCurrentFeedbackPage"),i}},deleteFeedback:function(e,t){var a=e.commit,n=(e.state,t.feedbackId),r=t.parentFeedbackId,s=t.feedback;return $.ajax({type:"DELETE",url:"/rest/feedbacks/feedback/delete/"+n,success:function(e){a("deleteFeedback",{feedbackId:n,parentFeedbackId:r,feedback:s})}})}},i=!1,o={state:function(){return{authenticatedUser:{},counts:{},feedbacks:[],itemAttributes:[],pagination:{isLastPage:!0,lastPage:1,currentPage:1}}},mutations:s,actions:c,getters:{}};function u(e,t){return e.filter((function(e){return e.id!==t}))}function f(e,t,a){return e.map((function(e){return t===e.id&&(e.replies=e.replies.filter((function(e){return e.id!==a}))),e}))}function d(e){var t=0;t+=5*e.counts.ratingsCountOf5,t+=4*e.counts.ratingsCountOf4,t+=3*e.counts.ratingsCountOf3,t+=2*e.counts.ratingsCountOf2,t+=1*e.counts.ratingsCountOf1,t/=e.counts.ratingsCountTotal,e.counts.averageValue=t}var l={created:function(){this.$store.hasModule("feedback")||App.isSSR||this.$store.registerModule("feedback",o,{preserveState:!!this.$store.state.feedback})}}},2772:function(e,t,a){var n=a(2109),r=a(1318).indexOf,s=a(9341),c=[].indexOf,i=!!c&&1/[1].indexOf(1,-0)<0,o=s("indexOf");n({target:"Array",proto:!0,forced:i||!o},{indexOf:function(e){return i?c.apply(this,arguments)||0:r(this,e,arguments.length>1?arguments[1]:void 0)}})},8234:function(e,t,a){a.r(t),a.d(t,{default:function(){return f}});var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.showEmptyRatings||e.counts.averageValue>0?a("div",{staticClass:"feedback-stars-average",class:e.size},[a("div",{staticClass:"feedback-stars-background clearfix"},e._l(5,(function(e){return a("div",{key:"star_background_"+e,staticClass:"feedback-star"},[a("i",{staticClass:"fa fa-star"})])})),0),e._v(" "),a("div",{staticClass:"feedback-stars-overlay-wrap",style:{width:e.fill}},[a("div",{staticClass:"feedback-stars-overlay clearfix"},e._l(5,(function(e){return a("div",{key:"star_overlay_"+e,staticClass:"feedback-star"},[a("i",{staticClass:"fa fa-star"})])})),0)])]):e._e(),e._v(" "),e.showRatingsAmount&&(e.showEmptyRatings||e.counts.averageValue>0)?a("span",{class:e.size},[a("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.scrollTo(t)}}},[e._v("("+e._s(e.counts.ratingsCountTotal)+")")])]):e._e()])};n._withStripped=!0;a(2526),a(7327),a(9554),a(2772),a(5003),a(9337),a(7941),a(4747);var r=a(629);function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var i={name:"FeedbackAverage",mixins:[a(2692).Z],inject:{itemId:{default:null}},props:{showEmptyRatings:Boolean,sizeOfStars:{type:String,default:"small"},showRatingsAmount:Boolean},computed:function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({fill:function(){var e=100*this.counts.averageValue/5;return e+="%"},size:function(){return-1!==this.sizeOfStars.indexOf("-stars")?this.sizeOfStars:this.sizeOfStars+"-stars"}},(0,r.rn)({counts:function(e){return e.feedback.counts}})),mounted:function(){App.isShopBuilder||this.getAverage()},methods:{getAverage:function(){this.$store.dispatch("loadFeedbackCounts",this.itemId)},scrollTo:function(){var e=document.querySelector("[data-feedback]"),t=document.querySelector("#vue-app").offsetTop;if(e){for(;(!e.clientHeight||!e.classList.contains("widget"))&&e.parentElement;)e=e.parentElement;if(e){var a=e.getBoundingClientRect().top+window.scrollY-t;window.scrollTo({top:a,behavior:"smooth"})}}}}},o=i,u=(0,a(1900).Z)(o,n,[],!1,null,null,null);u.options.__file="resources/js/src/app/components/item/FeedbackAverage.vue";var f=u.exports}}]);
//# sourceMappingURL=feedback-5.min.js.map