"use strict";(self.webpackChunkplentymarkets_feedback=self.webpackChunkplentymarkets_feedback||[]).push([[4],{4304:function(e,t,n){n.d(t,{A:function(){return l}});n(8706),n(2008),n(2062),n(6099);var a=!1,r=!1,s={setFeedbackAuthenticatedUser:function(e,t){e.authenticatedUser=t},setFeedbackCounts:function(e,t){e.counts=t},setFeedbacks:function(e,t){e.feedbacks=e.feedbacks.concat(t)},setFeedbackItemAttributes:function(e,t){e.itemAttributes=t},setFeedbackPagination:function(e,t){e.pagination.lastPage=t.lastPage,e.pagination.isLastPage=t.isLastPage},incrementCurrentFeedbackPage:function(e){e.pagination.currentPage++},addFeedback:function(e,t){if(e.feedbacks.unshift(t),t.isVisible){var n=parseInt(t.feedbackRating.rating.ratingValue);n>0&&n<=5&&(e.counts["ratingsCountOf"+n]++,e.counts.ratingsCountTotal++,d(e))}},deleteFeedback:function(e,t){var n=t.feedbackId,a=t.parentFeedbackId,r=t.feedback;if(r.isVisible&&null===a){var s=parseInt(r.feedbackRating.rating.ratingValue);s>0&&s<=5&&(e.counts["ratingsCountOf"+s]--,e.counts.ratingsCountTotal--,d(e))}null===a?(e.feedbacks=u(e.feedbacks,n),e.authenticatedUser.feedbacks=u(e.authenticatedUser.feedbacks,n)):(e.feedbacks=f(e.feedbacks,a,n),e.authenticatedUser.feedbacks=f(e.authenticatedUser.feedbacks,a,n))}},i={loadFeedbackUser:function(e,t){var n=e.commit,a=t.itemId,s=t.variationId;if(!r){r=!0;var i="";return void 0!==a&&void 0!==s&&(i="/".concat(a,"/").concat(s)),$.ajax({type:"GET",url:"/rest/feedbacks/user"+i,success:function(e){n("setFeedbackAuthenticatedUser",e),r=!1},error:function(e,t,n){r=!1,console.error(n)}})}},loadFeedbackCounts:function(e,t){var n=e.commit;e.state;if(!o)return o=!0,$.ajax({type:"GET",url:"/rest/storefront/feedbacks/feedback/helper/counts/"+t,success:function(e){n("setFeedbackCounts",e.counts)},error:function(e,t,n){console.error(n)}})},loadPaginatedFeedbacks:function(e,t){var n=e.commit,r=e.state,s=t.itemId,i=t.feedbacksPerPage,o=t.language;if(!a){a=!0;var c=$.ajax({type:"GET",url:"/rest/storefront/feedbacks/feedback/helper/feedbacklist/"+s+"/"+r.pagination.currentPage,beforeSend:function(e){e.setRequestHeader("lang",o)},data:{feedbacksPerPage:i},success:function(e){n("setFeedbacks",e.feedbacks),n("setFeedbackItemAttributes",e.itemAttributes),n("setFeedbackPagination",e.pagination),a=!1},error:function(e,t,n){console.error(n),a=!1}});return n("incrementCurrentFeedbackPage"),c}},deleteFeedback:function(e,t){var n=e.commit,a=(e.state,t.feedbackId),r=t.parentFeedbackId,s=t.feedback;return $.ajax({type:"DELETE",url:"/rest/feedbacks/feedback/delete/"+a,success:function(e){n("deleteFeedback",{feedbackId:a,parentFeedbackId:r,feedback:s})}})}},o=!1,c={state:function(){return{authenticatedUser:{},counts:{},feedbacks:[],itemAttributes:[],pagination:{isLastPage:!0,lastPage:1,currentPage:1}}},mutations:s,actions:i,getters:{}};function u(e,t){return e.filter((function(e){return e.id!==t}))}function f(e,t,n){return e.map((function(e){return t===e.id&&(e.replies=e.replies.filter((function(e){return e.id!==n}))),e}))}function d(e){var t=0;t+=5*e.counts.ratingsCountOf5,t+=4*e.counts.ratingsCountOf4,t+=3*e.counts.ratingsCountOf3,t+=2*e.counts.ratingsCountOf2,t+=1*e.counts.ratingsCountOf1,t/=e.counts.ratingsCountTotal,e.counts.averageValue=t}var l={created:function(){this.$store.hasModule("feedback")||App.isSSR||this.$store.registerModule("feedback",c,{preserveState:!!this.$store.state.feedback})}}},1813:function(e,t,n){n.r(t),n.d(t,{default:function(){return f}});n(3771);var a=function(){var e=this,t=e._self._c;return t("div",[e.showEmptyRatings||e.counts.averageValue>0?t("div",{staticClass:"feedback-stars-average",class:e.size},[t("div",{staticClass:"feedback-stars-background clearfix"},e._l(5,(function(e){return t("div",{key:"star_background_"+e,staticClass:"feedback-star"},[t("i",{staticClass:"fa fa-star"})])})),0),e._v(" "),t("div",{staticClass:"feedback-stars-overlay-wrap",style:{width:e.fill}},[t("div",{staticClass:"feedback-stars-overlay clearfix"},e._l(5,(function(e){return t("div",{key:"star_overlay_"+e,staticClass:"feedback-star"},[t("i",{staticClass:"fa fa-star"})])})),0)])]):e._e(),e._v(" "),e.showRatingsAmount&&(e.showEmptyRatings||e.counts.averageValue>0)?t("span",{class:e.size},[t("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.scrollTo.apply(null,arguments)}}},[e._v("("+e._s(e.counts.ratingsCountTotal)+")")])]):e._e()])};a._withStripped=!0;n(2675),n(9463),n(2259),n(5700),n(2008),n(3792),n(9572),n(2892),n(3851),n(1278),n(9432),n(6099),n(7764),n(3500),n(2953);var r=n(5353);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=s(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c={name:"FeedbackAverage",mixins:[n(4304).A],inject:{itemId:{default:null}},props:{showEmptyRatings:Boolean,sizeOfStars:{type:String,default:"small"},showRatingsAmount:Boolean},computed:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({fill:function(){var e=100*this.counts.averageValue/5;return e+="%"},size:function(){return-1!==this.sizeOfStars.indexOf("-stars")?this.sizeOfStars:this.sizeOfStars+"-stars"}},(0,r.aH)({counts:function(e){return e.feedback.counts}})),mounted:function(){App.isShopBuilder||this.getAverage()},methods:{getAverage:function(){this.$store.dispatch("loadFeedbackCounts",this.itemId)},scrollTo:function(){var e=document.querySelector("[data-feedback]"),t=document.querySelector("#vue-app").offsetTop;if(e){for(;(!e.clientHeight||!e.classList.contains("widget"))&&e.parentElement;)e=e.parentElement;if(e){var n=e.getBoundingClientRect().top+window.scrollY-t;window.scrollTo({top:n,behavior:"smooth"})}}}}},u=c,f=(0,n(4486).A)(u,a,[],!1,null,null,null).exports},4373:function(e,t,n){var a=n(8981),r=n(5610),s=n(6198);e.exports=function(e){for(var t=a(this),n=s(t),i=arguments.length,o=r(i>1?arguments[1]:void 0,n),c=i>2?arguments[2]:void 0,u=void 0===c?n:r(c,n);u>o;)t[o++]=e;return t}},3771:function(e,t,n){var a=n(6518),r=n(4373),s=n(6469);a({target:"Array",proto:!0},{fill:r}),s("fill")}}]);
//# sourceMappingURL=feedback-4.min.js.map